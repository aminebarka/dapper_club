{% extends 'base.html' %}
{% load static %}
{% block content %}


<!-- Shop Details Section Begin -->
<section class="shop-details">


    <div class="product__details__pic">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="product__details__breadcrumb">
                        <a href="{% url 'index' %}">Home</a>
                        <a href="{% url 'store' %}">Shop</a>
                        <span>Product Details</span>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-3 col-md-3">
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" data-toggle="tab" href="#tabs-1" role="tab">
                                <div class="product__thumb__pic set-bg" data-setbg="{{ product.image1.url }}">
                                </div>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#tabs-2" role="tab">
                                <div class="product__thumb__pic set-bg" data-setbg="{{ product.image2.url }}">
                                </div>
                            </a>
                        </li> 
                        <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#tabs-3" role="tab">
                                <div class="product__thumb__pic set-bg" data-setbg="{{ product.image3.url }}">
                                </div>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#tabs-4" role="tab">
                                <div class="product__thumb__pic set-bg" data-setbg="{{ product.image4.url }}">
                                </div>
                            </a>
                        </li>

                    </ul>
                </div>
                <div class="col-lg-6 col-md-9">
                    <div class="tab-content">
                        <div class="tab-pane active" id="tabs-1" role="tabpanel">
                            <div class="product__details__pic__item">
                                <input type="hidden" value="{{ product.image1.url }}" class="prod_img">
                                <img class="" src="{{ product.image1.url }}" alt="">
                            </div>
                        </div>
                        <div class="tab-pane" id="tabs-2" role="tabpanel">
                            <div class="product__details__pic__item">
                                <img src="{{ product.image2.url }}" alt="">
                            </div>
                        </div>
                        <div class="tab-pane" id="tabs-3" role="tabpanel">
                            <div class="product__details__pic__item">
                                <img src="{{ product.image3.url }}" alt="">
                            </div>
                        </div>
                        <div class="tab-pane" id="tabs-4" role="tabpanel">
                            <div class="product__details__pic__item">
                                <img src="{{ product.image4.url }}" alt="">
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="product__details__content">
        <div class="container">

            <div class="row d-flex justify-content-center">
                <div class="col-lg-8">
                    <div class="product__details__text">
                        <h4 class="prod_name">{{ product.product_name }}</h4>
                        <h6 class="prod_name">{{ product.brand.name }}</h6>
                        <header class="section-heading">
                            <div class="rating-star d-flex justify-content-center">
                                <span>
                                    <i class="fa fa-star{% if product.averageReview < 0.5 %} disable {% elif product.averageReview >= 0.5 and product.averageReview < 1 %}-half-o {% endif %}"
                                        aria-hidden="true"></i>
                                    <i class="fa fa-star{% if product.averageReview < 1.5 %} disable {% elif product.averageReview >= 1.5 and product.averageReview < 2 %}-half-o {% endif %}"
                                        aria-hidden="true"></i>
                                    <i class="fa fa-star{% if product.averageReview < 2.5 %} disable {% elif product.averageReview >= 2.5 and product.averageReview < 3 %}-half-o {% endif %}"
                                        aria-hidden="true"></i>
                                    <i class="fa fa-star{% if product.averageReview < 3.5 %} disable {% elif product.averageReview >= 3.5 and product.averageReview < 4 %}-half-o {% endif %}"
                                        aria-hidden="true"></i>
                                    <i class="fa fa-star{% if product.averageReview < 4.5 %} disable {% elif product.averageReview >= 4.5 and product.averageReview < 5 %}-half-o {% endif %}"
                                        aria-hidden="true"></i>
                                    <span class="mx-3">{{product.countReview}} reviews</span>
                                </span>
                            </div>
        
                        </header>
                        <h3 class=""> ₹ <span class="prod_price">{{ product.price }}</span> </h3>
                        <p>{{ product.description }}</p>
                        <div class="product__details__option row">
                            <div class="product__details__option__size col-md-5">
                                <span>Choose Size:</span>
                                {% for size in sizes %}

                                <button
                                    class="btn btn-sm btn-outline-secondary choose-size size{{ size.id }} color{{size.color__id}} stock-{{size.id}}"
                                    prod-id="{{ size.id }}" stock="{{size.stock}}">{{ size.size__size }}</button>


                                <!-- <label class="choose-size color{{size.color__id}}" data-size="{{ size.id }}" for="">{{ size.size__size }}
                                        <input type="radio" id="">
                                    </label> -->
                                <!-- {{size.id}} -->
                                {% endfor %} 

                            </div>
                            <div class="product__details__option__color col-md-5">
                                <span class="">Color:</span>
                                {% for color in colors %}

                                <button
                                    class="btn btn-lg btn-outline-secondary choose-color color-{{color.color__id}}"
                                    data-color="{{color.color__id}}" color="{{color.color__name}}"
                                    style="background-color: {{color.color__color_code}}"></button>
                                {% endfor %}
                            </div>
                        </div>
                        <div class="product__details__cart__option">

                            <b>
                                <h4 class="text-danger out-of-stock">Out of Stock<h4>
                            </b>

                            <input type="hidden" value="{{ product.id }}" class="prod_id">
                            <div class="quantity">
                                <div class="pro-qty">
                                    <input type="text" id="qty-input" value="1">
                                </div>
                            </div>

                            <!-- <a href="{{ product.get_url }}" class="primary-btn addtocart" id="addToCartBtn">add to cart</a> -->
                            <button class="primary-btn addtocart" id="addToCartBtn">add to cart</button>

                        </div>
                        <div class="product__details__btns__option">
                            {% if not in_wishlist %} 
                            <p class="m-2 text-warning" id="addtowishlist" prod-id="{{ product.id }}"><i class="fa fa-heart "></i> add to wishlist</p>
                            {% else %}
                            <div class="m-2 text-danger delete-wish" data-item="{{ product.id }}"><i class="fa fa-heart "></i> Remove from wishlist </div>
                            {% endif %}

                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <div class="product__details__tab">
                        <ul class="nav nav-tabs" role="tablist">
                            <!-- <li class="nav-item">
                                    <a class="nav-link active" data-toggle="tab" href="#tabs-5"
                                    role="tab">Description</a>
                                </li> -->
                            <li class="nav-item">
                                <a class="nav-link active" data-toggle="tab" href="#tabs-6" role="tab">Customer
                                    reviews({{product.countReview}})</a>
                            </li>
                        </ul>
                        <div class="tab-content">
                            <div class="tab-pane active" id="tabs-6" role="tabpanel">
                                <div class="product__details__tab__content">
                                    <div class="product__details__tab__content__item">
                                        <header class="section-heading">
                                            <div class="rating-star d-flex justify-content-center">
                                                <span>
                                                    <i class="fa fa-star{% if product.averageReview < 0.5 %} disable {% elif product.averageReview >= 0.5 and product.averageReview < 1 %}-half-o {% endif %}"
                                                        aria-hidden="true"></i>
                                                    <i class="fa fa-star{% if product.averageReview < 1.5 %} disable {% elif product.averageReview >= 1.5 and product.averageReview < 2 %}-half-o {% endif %}"
                                                        aria-hidden="true"></i>
                                                    <i class="fa fa-star{% if product.averageReview < 2.5 %} disable {% elif product.averageReview >= 2.5 and product.averageReview < 3 %}-half-o {% endif %}"
                                                        aria-hidden="true"></i>
                                                    <i class="fa fa-star{% if product.averageReview < 3.5 %} disable {% elif product.averageReview >= 3.5 and product.averageReview < 4 %}-half-o {% endif %}"
                                                        aria-hidden="true"></i>
                                                    <i class="fa fa-star{% if product.averageReview < 4.5 %} disable {% elif product.averageReview >= 4.5 and product.averageReview < 5 %}-half-o {% endif %}"
                                                        aria-hidden="true"></i>
                                                    <span class="mx-3">{{product.countReview}} reviews</span>
                                                </span>
                                            </div>
                        
                                        </header>
                                        {% for review in reviews %}
                    <article class="box m-3 p-3 card">
                        <div class="icontext w-100">
    
                            <div class="text">
                                <span class="date text-muted float-md-right">{{review.updated_at}} </span>
                                <h6 class="mb-1">{{review.user.full_name}} </h6>
                                <div class="rating-star">
                                    <span>
                                        
                                        <i class="fa fa-star{% if review.rating == 0.5 %}-half-o{% elif review.rating < 1 %} disable {% endif %}"
                                            aria-hidden="true"></i>
                                        <i class="fa fa-star{% if review.rating == 1.5 %}-half-o{% elif review.rating < 2 %} disable {% endif %}"
                                            aria-hidden="true"></i>
                                        <i class="fa fa-star{% if review.rating == 2.5 %}-half-o{% elif review.rating < 3 %} disable {% endif %}"
                                            aria-hidden="true"></i>
                                        <i class="fa fa-star{% if review.rating == 3.5 %}-half-o{% elif review.rating < 4 %} disable {% endif %}"
                                            aria-hidden="true"></i>
                                        <i class="fa fa-star{% if review.rating == 4.5 %}-half-o{% elif review.rating < 5 %} disable {% endif %}"
                                            aria-hidden="true"></i>
                                            <span class="mx-2">{{review.rating}}</span>
                                    </span>
                                </div>
                            </div>
                        </div> <!-- icontext.// -->
                        <div class="mt-3">
                            <h6>{{review.subject}}</h6>
                            <p>
                                {{review.review}}
                            </p>
                        </div>
                    </article>
                    {% endfor %}
                    <hr class="my-5">

                                        <form action="{% url 'submit_review' product.id %}" method="POST">
                                            {% csrf_token %}
                                            <h5>Write Your Review</h5>
 
                                            <div>
                                                <!-- Rating stars -->
                                                <label>How do you rate this product?</label>
                                                <br>
                                                <div class="rate">
                                                    <input type="radio" name="rating" id="rating10" value="5"
                                                        required /><label for="rating10" title="5"></label>
                                                    <input type="radio" name="rating" id="rating9" value="4.5"
                                                        required /><label for="rating9" title="4.5"
                                                        class="half"></label>
                                                    <input type="radio" name="rating" id="rating8" value="4"
                                                        required /><label for="rating8" title="4"></label>
                                                    <input type="radio" name="rating" id="rating7" value="3.5"
                                                        required /><label for="rating7" title="3.5"
                                                        class="half"></label>
                                                    <input type="radio" name="rating" id="rating6" value="3"
                                                        required /><label for="rating6" title="3"></label>
                                                    <input type="radio" name="rating" id="rating5" value="2.5"
                                                        required /><label for="rating5" title="2.5"
                                                        class="half"></label>
                                                    <input type="radio" name="rating" id="rating4" value="2"
                                                        required /><label for="rating4" title="2"></label>
                                                    <input type="radio" name="rating" id="rating3" value="1.5"
                                                        required /><label for="rating3" title="1.5"
                                                        class="half"></label>
                                                    <input type="radio" name="rating" id="rating2" value="1"
                                                        required /><label for="rating2" title="1"></label>
                                                    <input type="radio" name="rating" id="rating1" value="0.5"
                                                        required /><label for="rating1" title="0.5"
                                                        class="half"></label>
                                                </div>
                                                <br>
                                                Review Title:
                                                <input type="text" class="form-control" name="subject">
                                                <br>
                                                Review:
                                                <textarea name="review" rows="4" class="form-control"></textarea>
                                                <br>

                                                {% if user.is_authenticated %}
                                                {% if is_ordered %}
                                                <button type="submit" value="Submit Review" class="btn btn-dark">Submit Review</button>
                                                {% else %}
                                                <p>You must purchase this product to post review. </p>
                                                {% endif %}

                                                {% else %}

                                                <p>You must be logged in to post a review. <span><a
                                                            href="{% url 'signin' %}">Login now</a></span></p>
                                                {% endif %}
                                            </div>
                                            {% include 'includes/alerts.html' %}
                                        </form>
                                    </div>
                                    <hr>
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Shop Details Section End -->

<!-- Related Section Begin -->
<section class="related spad">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <h3 class="related-title">Related Product</h3>
            </div>
        </div>
        <div class="row">
            {% for product in related %}

            <div class="col-md-3 col-sm-6">
                <div class="product-grid">
                    <div class="product-image">
                        <a href="{{ product.get_url }}" class="image">
                            <img class="img-1" src="{{ product.image1.url }}" width="200" height="200">
                            <img class="img-2" src="{{ product.image2.url }}" width="200" height="200">
                        </a>
                        <ul class="product-links">
                            <li>
                                <div id="addtowishlist" prod-id="{{ product.id }}"><i class="fa fa-heart"></i></div>
                            </li>
                            <li>
                                <div><i class="fa fa-random"></i></div>
                            </li>
                        </ul>
                        <a href="#" class="product-view"><i class="fa fa-search"></i></a>
                    </div>
                    <div class="product-content">
                        <header class="section-heading">
                            <div class="rating-star d-flex justify-content-center">
                                <span>
                                    <i class="fa fa-star{% if product.averageReview < 0.5 %} disable {% elif product.averageReview >= 0.5 and product.averageReview < 1 %}-half-o {% endif %}"
                                        aria-hidden="true"></i>
                                    <i class="fa fa-star{% if product.averageReview < 1.5 %} disable {% elif product.averageReview >= 1.5 and product.averageReview < 2 %}-half-o {% endif %}"
                                        aria-hidden="true"></i>
                                    <i class="fa fa-star{% if product.averageReview < 2.5 %} disable {% elif product.averageReview >= 2.5 and product.averageReview < 3 %}-half-o {% endif %}"
                                        aria-hidden="true"></i>
                                    <i class="fa fa-star{% if product.averageReview < 3.5 %} disable {% elif product.averageReview >= 3.5 and product.averageReview < 4 %}-half-o {% endif %}"
                                        aria-hidden="true"></i>
                                    <i class="fa fa-star{% if product.averageReview < 4.5 %} disable {% elif product.averageReview >= 4.5 and product.averageReview < 5 %}-half-o {% endif %}"
                                        aria-hidden="true"></i>
                                    <span class="mx-3">{{product.countReview}} reviews</span>
                                </span>
                            </div>
        
                        </header>
                        <h3 class="title"><a href="{{ product.get_url }}">{{ product.product_name }}</a></h3>
                        <div class="price">₹ {{ product.price }}</div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
<!-- Related Section End -->
{% endblock %}